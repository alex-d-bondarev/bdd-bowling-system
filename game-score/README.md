# GameScore

Development and testing
---

Run `mvn clean install` to ensure that you did not break this project

The following maven phases are used:

|Phase (command)|Comment|
|---------------|-------|
|`mvn clean`|Remove all files generated by the previous build|
|`mvn compile`|Compile the code|
|`mvn test`|Run unit tests|
|`mvn package`|Package JAR + (Additional) build docker image|
|`mvn pre-integration-test` |(Additional) run docker container|
|`mvn integration-test`|**TBD** (Additional) run integration tests against app in docker|
|`mvn post-integration-test`|(Additional) stop docker container|
|`mvn install`|Install the package into the local repository, for use as a dependency in other projects locally|

Additional logic was added in project pom.

How to use the GameScore application from terminal
---

### Start

1. Download Docker from https://www.docker.com/get-docker
1. Install Docker
1. Ensure that previous container is not running. Stop and remove if needed:
    ```shell script
    docker stop game-score
    docker rm game-score
    ```
1. Run `pre-integration-test` to build your application and start it in Docker container locally
1. To check that your application is running enter url `http://localhost:8081/healthcheck`
1. Go to (Use launched application)[#use-launched-application] section

### Stop

- Run `mvn clean` to stop container and remove the image

OR 

- Use docker API like `docker stop game-score` for manual docker management

How to use the GameScore application from IDE
---

Set the following:
- Main class = `org.practice.app.GameScoreApplication`
- Program arguments = `server config.yml`
Use IDE controls to start and stop the game-score application

Use launched application:
---

### Health Check

To see your applications health enter url `http://localhost:8081/healthcheck`

### Endpoint

#### Score Rolls 

`/scoreRolls` with POST only request. 
See [tdd-bowling-game](https://github.com/alex-d-bondarev/tdd-bowling-game) for more details.

Max score example:
```shell script
## Request:
curl -s http://localhost:8080/scoreRolls \
-H "Content-Type: application/json" \
--request POST \
--data '{"id":"1","rolls":[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]}' \
| jq .

## Expected response:
{
  "rolls": [
    10,
    10,
    10,
    10,
    10,
    10,
    10,
    10,
    10,
    10,
    10,
    10
  ],
  "score": 300,
  "id": 1
}
```